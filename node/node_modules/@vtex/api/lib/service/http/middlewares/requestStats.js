"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class IncomingRequestStats {
    constructor() {
        this.aborted = 0;
        this.closed = 0;
        this.total = 0;
    }
    get() {
        return {
            aborted: this.aborted,
            closed: this.closed,
            total: this.total,
        };
    }
    clear() {
        this.aborted = 0;
        this.closed = 0;
        this.total = 0;
    }
}
exports.incomingRequestStats = new IncomingRequestStats();
const requestClosed = () => {
    exports.incomingRequestStats.closed++;
};
const requestAborted = () => {
    exports.incomingRequestStats.aborted++;
};
async function trackIncomingRequestStats(ctx, next) {
    ctx.req.on('close', requestClosed);
    ctx.req.on('aborted', requestAborted);
    exports.incomingRequestStats.total++;
    await next();
}
exports.trackIncomingRequestStats = trackIncomingRequestStats;
